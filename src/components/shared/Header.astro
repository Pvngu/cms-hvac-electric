---
import { Icon } from "astro-icon/components";
import Container from "@components/ui/Container.astro";
import Button from "@components/ui/Button.astro";
import Image from "astro/components/Image.astro";
import logo from "@assets/logo.svg";
import MobileMenu from "@components/shared/MobileMenu.astro";
import { NAV_LINKS, SITE_DATA } from "@data/site";
---

<header
  id="main-header"
  class="fixed top-0 w-full z-50 transition-all duration-300 border-b border-transparent"
>
  <Container class="flex items-center h-20">
    <!-- Logo -->
    <div class="flex-1 flex justify-start">
      <a href="/" class="flex items-center gap-2 group">
        <Image src={logo} alt="Logo" class="w-20 h-20 fill-white text-white" />
      </a>
    </div>

    <!-- Navigation -->
    <nav class="hidden md:flex items-center gap-8">
      {
        NAV_LINKS.map((link) => (
          <Button href={link.href} variant="nav">
            {link.label}
          </Button>
        ))
      }
    </nav>

    <!-- Actions -->
    <div class="flex-1 flex items-center justify-end gap-6">
      <a
        href={`tel:${SITE_DATA.tel}`}
        class="hidden lg:flex items-center gap-2 text-white/90 hover:text-white transition-colors text-sm font-medium"
      >
        <Icon name="phone-call" class="size-4" />
        <span>{SITE_DATA.phone}</span>
      </a>

      <div class="hidden sm:block">
        <Button
          variant="primary"
          size="sm"
          class="bg-black hover:bg-black/80 text-white border border-white/10 rounded-lg px-6 font-medium"
        >
          Sign Up
        </Button>
      </div>

      <!-- Hamburger Menu Button -->
      <button
        id="hamburger-btn"
        class="md:hidden p-2 text-white hover:text-white/80 transition-colors"
        aria-label="Open menu"
      >
        <Icon name="menu" class="size-6" />
      </button>
    </div>
  </Container>
</header>

<MobileMenu />

<script>
  const header = document.getElementById("main-header");
  const hamburgerBtn = document.getElementById("hamburger-btn");
  const mobileMenu = document.getElementById("mobile-menu");

  const updateHeader = () => {
    if (!header) return;
    if (window.scrollY > 20) {
      header.classList.add(
        "bg-slate-900/90",
        "backdrop-blur-md",
        "border-white/5",
        "shadow-lg",
      );
      header.classList.remove("border-transparent");
    } else {
      header.classList.remove(
        "bg-slate-900/90",
        "backdrop-blur-md",
        "border-white/5",
        "shadow-lg",
      );
      header.classList.add("border-transparent");
    }
  };

  const openList = () => {
    if (mobileMenu) {
      mobileMenu.dataset.open = "true";
      document.body.style.overflow = "hidden"; // Prevent scrolling when menu is open
    }
  };

  window.addEventListener("scroll", updateHeader);
  hamburgerBtn?.addEventListener("click", openList);

  // Initial check in case of reload
  updateHeader();
</script>
